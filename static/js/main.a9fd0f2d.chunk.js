(this["webpackJsonpid-photo"]=this["webpackJsonpid-photo"]||[]).push([[0],{114:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var i=n(5),a=n(0),c=n.n(a),h=n(21),o=n.n(h),r=(n(83),n(19));n(84);var s=function(e){var t=function(e,t,n,i,a){e.beginPath(),e.moveTo(t,n),e.lineTo(i,a),e.stroke()};return Object(a.useEffect)((function(){var n=e.size,i=e.canvasRef.current;if(e.image){var a=new OffscreenCanvas(n.width,n.height).getContext("2d");a.fillStyle="#ffffff",a.fillRect(0,0,n.width,n.height),a.translate(n.width/2,n.height/2),a.translate(e.offset.x,e.offset.y),a.rotate(e.rotate),a.scale(e.zoom,e.zoom),a.translate(e.position.x,e.position.y),a.drawImage(e.image,-n.width/2,-n.height/2);var c=a.getImageData(0,0,n.width,n.height);if(function(e,t){if(1!==t)for(var n=0;n<e.length;n+=4)e[n]*=t,e[n+1]*=t,e[n+2]*=t}(c.data,e.bright),function(e,t){if(1!==t)for(var n=0;n<e.length;n+=4)e[n]=(e[n]-128)*t+128,e[n+1]=(e[n+1]-128)*t+128,e[n+2]=(e[n+2]-128)*t+128}(c.data,e.contrast),(a=i.getContext("2d")).clearRect(0,0,n.width,n.height),a.putImageData(c,0,0),e.hint){a.strokeStyle="#ffffffa0";var h=n.height/8;t(a,0,h,n.width,h);var o=h+2*n.height/3;t(a,0,o,n.width,o);var r=n.width/2;t(a,r,h,r,o)}}else{var s=i.getContext("2d");s.clearRect(0,0,n.width,n.height);var d="\u9ede\u64ca\u6b64\u8655\u8f09\u5165\u5716\u6a94";s.measureText(d);s.fillStyle="#000000",s.textAlign="center",s.font="28px sans-serif",s.fillText(d,n.width/2,n.height/2)}}),[e]),Object(i.jsx)("canvas",{ref:e.canvasRef,width:e.size.width,height:e.size.height})},d=n(119);n(85),n(43);var l=function(e){var t=Object(a.useState)(100),n=Object(r.a)(t,2),c=n[0],h=n[1],o=Object(a.useState)(0),s=Object(r.a)(o,2),l=s[0],j=s[1],f=Object(a.useState)(100),g=Object(r.a)(f,2),u=g[0],b=g[1],v=Object(a.useState)(100),O=Object(r.a)(v,2),x=O[0],m=O[1],w=function(t){h(t),e.onZoomChanged(t/100)},p=function(t){j(t),e.onRotateChanged(3.1416*t/180)},C=function(t){b(t),e.onBrightChanged(t/100)},y=function(t){m(t),e.onContrastChanged(t/100)};return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"row",children:[Object(i.jsx)("span",{children:"\u5927\u5c0f"}),Object(i.jsx)(d.a,{min:20,max:300,value:c,onChange:w})]}),Object(i.jsxs)("div",{className:"row",children:[Object(i.jsx)("span",{children:"\u65cb\u8f49"}),Object(i.jsx)(d.a,{min:-180,max:180,value:l,onChange:p})]}),Object(i.jsxs)("div",{className:"row",children:[Object(i.jsx)("span",{children:"\u4eae\u5ea6"}),Object(i.jsx)(d.a,{min:50,max:200,value:u,onChange:C})]}),Object(i.jsxs)("div",{className:"row",children:[Object(i.jsx)("span",{children:"\u5c0d\u6bd4"}),Object(i.jsx)(d.a,{min:50,max:200,value:x,onChange:y})]}),Object(i.jsx)("button",{ref:e.resetRef,className:"hidden",onClick:function(){w(100),p(0),C(100),y(100)},children:"Reset"})]})},j=n(118);var f=function(e){return Object(i.jsxs)(i.Fragment,{children:["\u9078\u64c7\u8f38\u51fa\u5c3a\u5bf8",Object(i.jsx)(j.a,{style:{width:230},value:e.value,onChange:e.onChange,children:e.options.map((function(e,t){return Object(i.jsx)(j.a.Option,{value:t,children:e.name},t)}))})]})};var g=function(e){return Object(i.jsxs)(i.Fragment,{children:["\u9078\u64c7\u7167\u7247\u5c3a\u5bf8",Object(i.jsx)(j.a,{style:{width:230},value:e.value,onChange:e.onChange,children:e.options.map((function(e,t){return Object(i.jsx)(j.a.Option,{value:t,children:e.name},t)}))})]})},u=n(121);n(114);var b=function(){var e=Object(a.useState)(0),t=Object(r.a)(e,2),n=t[0],c=t[1],h=Object(a.useState)(null),o=Object(r.a)(h,2),d=o[0],j=o[1],b=Object(a.useState)({x:0,y:0}),v=Object(r.a)(b,2),O=v[0],x=v[1],m=Object(a.useState)({x:0,y:0}),w=Object(r.a)(m,2),p=w[0],C=w[1],y=Object(a.useState)(1),S=Object(r.a)(y,2),T=S[0],R=S[1],k=Object(a.useState)(0),E=Object(r.a)(k,2),N=E[0],F=E[1],M=Object(a.useState)(1),z=Object(r.a)(M,2),A=z[0],I=z[1],D=Object(a.useState)(1),L=Object(r.a)(D,2),B=L[0],P=L[1],U=Object(a.useState)(0),J=Object(r.a)(U,2),V=J[0],X=J[1],Y=Object(a.useState)(!0),Z=Object(r.a)(Y,2),q=Z[0],G=Z[1],H=Object(a.useState)(0),K=Object(r.a)(H,2),Q=K[0],W=K[1],$=Object(a.useState)({}),_=Object(r.a)($,2),ee=_[0],te=_[1],ne=Object(a.useRef)(),ie=Object(a.useRef)(),ae=[{width:331,height:413,name:"1 \u540b\u8b49\u4ef6\u7167 (2.8 x 3.5 \u516c\u5206)"},{width:413,height:531,name:"2 \u540b\u5927\u982d\u7167 (3.5 x 4.5 \u516c\u5206)"},{width:496,height:555,name:"2 \u540b\u534a\u8eab\u7167 (4.2 x 4.7 \u516c\u5206)"},{width:591,height:591,name:"\u7f8e\u570b\u7c3d\u8b49 (5 x 5 \u516c\u5206)"},{width:354,height:472,name:"\u65e5\u672c\u7c3d\u8b49 (3 x 4 \u516c\u5206)"}],ce=[{width:0,height:0,name:"\u55ae\u5f35\u5716\u6a94"},{width:1500,height:900,name:"3 x 5 \u540b\u7167\u7247"},{width:1800,height:1200,name:"4 x 6 \u540b\u7167\u7247"}];return Object(a.useEffect)((function(){if(!1===q){var e={width:ae[n].width,height:ae[n].height},t={width:ce[V].width,height:ce[V].height};0===V&&(t.width=e.width,t.height=e.height);var i=Math.floor(t.width/(e.width+2)),a=Math.floor(t.height/(e.height+2)),c=(t.width-e.width*i)/(i+1),h=(t.height-e.height*a)/(a+1),o=new OffscreenCanvas(t.width,t.height),r=o.getContext("2d");r.strokeStyle="#000000",r.fillStyle="#ffffff",r.fillRect(0,0,t.width,t.height);for(var s=0;s<a;++s)for(var d=0;d<i;++d){var l=(c+e.width)*d+c,j=(h+e.height)*s+h;r.drawImage(ne.current,l,j),(i>1||a>1)&&(r.beginPath(),r.moveTo(l+5,j-1),r.lineTo(l-1,j-1),r.lineTo(l-1,j+5),r.moveTo(l+e.width+1-5,j-1),r.lineTo(l+e.width+1,j-1),r.lineTo(l+e.width+1,j+5),r.moveTo(l-1,j+e.height+1-5),r.lineTo(l-1,j+e.height+1),r.lineTo(l+5,j+e.height+1),r.moveTo(l+e.width+1,j+e.height+1-5),r.lineTo(l+e.width+1,j+e.height+1),r.lineTo(l+e.width-5,j+e.height+1),r.stroke())}o.convertToBlob({type:"image/jpeg",quality:.95}).then((function(e){var t=new FileReader;t.addEventListener("load",(function(){var e=document.createElement("a");e.href=t.result,e.download="photo.jpg",e.click()})),t.readAsDataURL(e)})),G(!0)}}),[q]),Object(i.jsxs)("div",{className:"container",onMouseDown:function(e){0===e.button&&"CANVAS"===e.target.tagName&&(W(1),te({x:e.nativeEvent.clientX,y:e.nativeEvent.clientY}),G(!0))},onMouseMove:function(e){0!==Q&&(1===Q&&W(2),C({x:e.nativeEvent.clientX-ee.x,y:e.nativeEvent.clientY-ee.y}))},onMouseUp:function(e){var t=Math.cos(N),n=Math.sin(N);x({x:O.x+(p.x*t+p.y*n)/T,y:O.y+(-p.x*n+p.y*t)/T}),C({x:0,y:0})},onClick:function(e){if(2!==Q&&"CANVAS"===e.target.tagName){var t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=function(e){var t=new FileReader;t.addEventListener("load",(function(){var e=document.createElement("img");e.src=t.result,j(e)})),t.readAsDataURL(e.target.files[0]),x({x:0,y:0}),C({x:0,y:0}),G(!0),ie.current.click()},t.click()}W(0)},children:[Object(i.jsx)("div",{children:Object(i.jsx)(g,{options:ae,value:n,onChange:function(e){c(parseInt(e)),G(!0)}})}),Object(i.jsx)("div",{children:Object(i.jsx)(s,{canvasRef:ne,size:ae[n],image:d,hint:q,position:O,offset:p,zoom:T,rotate:N,bright:A,contrast:B})}),Object(i.jsx)("div",{children:Object(i.jsx)(l,{onZoomChanged:function(e){R(e),G(!0)},onRotateChanged:function(e){F(e),G(!0)},onBrightChanged:I,onContrastChanged:P,resetRef:ie})}),Object(i.jsx)("p",{children:Object(i.jsx)(f,{options:ce,value:V,onChange:X})}),Object(i.jsx)("div",{children:Object(i.jsx)(u.a,{type:"primary",onClick:function(){G(!1)},children:"\u5132\u5b58\u6a94\u6848"})})]})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,122)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,h=t.getTTFB;n(e),i(e),a(e),c(e),h(e)}))};o.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(b,{})}),document.getElementById("root")),v()},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){}},[[115,1,2]]]);
//# sourceMappingURL=main.a9fd0f2d.chunk.js.map